# WhatsApp API Business Analysis

## Problem Statements
1. Identify all customers who have successfully opted into WhatsApp notifications but have not yet interacted with any WhatsApp messages.
2. Determine the total number of messages exchanged by customers in each region.
3. Calculate the total revenue generated by businesses from paid conversations.
4. Which message templates have been most frequently approved for use in campaigns?
5. Identify the top 5 customers based on the total number of messages they have sent and received.
6. Identify the top 3 agents with the highest average conversation quality rating.
7. Find the top customers who have contributed the most payments across all businesses.
8. Identify regions with the highest percentage of confirmed opt-ins.
9. Analyze how business revenues have changed over the months.
10. Calculate the retention rate (percentage of confirmed opt-ins) for each region based on total customers in the region.

## Database Schema Overview
```sql
SELECT CustomerID, Name, PhoneNumber, Region, OptInDate FROM Customers;
SELECT MessageID, SenderID, ReceiverID, SentTime, DeliveredTime, ReadTime, Status, MessageType FROM Messages;
SELECT OptInID, CustomerID, OptInDate, OptInMethod, OptInStatus FROM OptIns;
SELECT TemplateID, TemplateName, ApprovalStatus FROM Templates;
SELECT FeedbackID, CustomerID, MessageID, Rating, Comments FROM Feedback;
SELECT BusinessID, AccountStatus, VerificationStatus FROM BusinessAccounts;
SELECT ConversationID, BusinessID, CustomerID, MessagesSent, QualityRating FROM Conversations;
SELECT PaymentID, BusinessID, Amount, PaymentDate FROM Payments;
SELECT RegionID, RegionName FROM Regions;
SELECT AgentID, AgentName, BusinessID FROM Agents;
```

### Business Problem 1
Identify all customers who have successfully opted into WhatsApp notifications but have not yet interacted with any WhatsApp messages.

### Business Impact:
This analysis helps businesses understand gaps in customer engagement. By identifying these customers, businesses can target them with follow-up campaigns or
personalized content to encourage interaction and build better engagement.

```sql
SELECT c.CustomerID, c.Name, o.OptInDate, o.OptInMethod
FROM customers c
JOIN optins o
ON c.CustomerID = o.CustomerID
LEFT JOIN messages m
ON c.CustomerID = m.ReceiverID
WHERE o.OptInStatus = 'Confirmed' AND m.MessageID IS NULL
ORDER BY o.OptInDate;
```

### Business Problem 2
Determine the total number of messages exchanged by customers in each region.

### Business Impact:
This data helps businesses allocate resources more effectively by identifying regions with high communication activity.
It can also guide region-specific marketing strategies to improve customer engagement.
```sql
SELECT r.RegionName, COUNT(m.MessageID) AS total_messages
FROM regions r
JOIN customers c ON r.RegionName = c.Region
JOIN messages m ON c.CustomerID = m.SenderID OR c.CustomerID = m.ReceiverID
GROUP BY r.RegionName;
```
### Business Problem 3
Calculate the total revenue generated by businesses from paid conversations.

### Business Impact:
Understanding revenue contribution from conversations enables businesses to assess the profitability of their communication channels.
It provides a basis for scaling paid conversation services and optimizing pricing strategies.
```sql
SELECT b.BusinessID, b.AccountStatus, b.VerificationStatus, 
       SUM(p.Amount) AS total_revenue
FROM businessaccounts b
JOIN payments p ON b.BusinessID = p.BusinessID
JOIN conversations c ON b.BusinessID = c.BusinessID
WHERE c.MessagesSent > 0
GROUP BY b.BusinessID, b.AccountStatus, b.VerificationStatus;
```
### Business Problem 4
Which message templates have been most frequently approved for use in campaigns? Identifying these can help businesses prioritize templates for future communications.

### Business Impact:
This insight helps streamline template design by focusing on successful templates.
It ensures that future campaigns leverage templates that are likely to be approved and resonate well with target audiences.

```sql
SELECT TemplateID, TemplateName, COUNT(*) AS approval_count
FROM templates
WHERE ApprovalStatus = 'Approved'
GROUP BY TemplateID, TemplateName
ORDER BY approval_count DESC
LIMIT 5;
```
### Business Problem 5
Identify the top 5 customers based on the total number of messages they have sent and received.

### Business Impact:
Recognizing highly active customers helps businesses identify potential brand advocates or influencers.
It also enables targeted reward programs to enhance loyalty and engagement.

```sql
SELECT CustomerID, Name, total_messages
FROM (
    SELECT c.CustomerID, c.Name, COUNT(m.MessageID) AS total_messages, 
           DENSE_RANK() OVER (ORDER BY COUNT(m.MessageID) DESC) AS rank_
    FROM customers c
    JOIN messages m ON c.CustomerID = m.SenderID OR c.CustomerID = m.ReceiverID
    GROUP BY c.CustomerID, c.Name
) ranked_customers
WHERE rank_ <= 5;
```
### Business Problem 6
Identify the top 3 agents with the highest average conversation quality rating.

### Business Impact:
Highlighting top-performing agents allows businesses to implement best practices across teams.
It fosters healthy competition and improves overall service quality, leading to better customer satisfaction.

```sql
WITH AgentRatings AS (
    SELECT a.AgentID, a.AgentName, AVG(c.QualityRating) AS avg_rating
    FROM agents a
    JOIN conversations c ON a.BusinessID = c.BusinessID
    GROUP BY a.AgentID, a.AgentName
)
SELECT AgentID, AgentName, avg_rating
FROM (
    SELECT AgentID, AgentName, avg_rating,
    RANK() OVER (ORDER BY avg_rating DESC) AS rank_
    FROM AgentRatings
) ranked_agents
WHERE rank_ <= 3;
```
### Business Problem 7
Find the top customers who have contributed the most payments across all businesses.

### Business Impact:
Identifying high-value customers helps businesses focus retention efforts and design personalized reward programs.
It also guides upselling or cross-selling strategies to maximize revenue.

```sql
WITH RankedCustomers AS (
    SELECT c.CustomerID, c.Name, SUM(p.Amount) AS total_payments,
           DENSE_RANK() OVER (ORDER BY SUM(p.Amount) DESC) AS rank_
    FROM customers c
    JOIN conversations co ON c.CustomerID = co.CustomerID
    JOIN payments p ON co.BusinessID = p.BusinessID
    GROUP BY c.CustomerID, c.Name
)
SELECT CustomerID, Name, total_payments, rank_
FROM RankedCustomers
WHERE rank_ <= 3;
```
### Business Problem 8
Identify regions with the highest percentage of confirmed opt-ins.

### Business Impact:
Understanding regional opt-in trends enables businesses to replicate successful opt-in strategies in underperforming areas.
It helps maximize the reach of WhatsApp campaigns.

```sql
SELECT r.RegionName, 
       COUNT(CASE WHEN o.OptInStatus = 'Confirmed' THEN 1 END) * 100.0 / COUNT(o.OptInID) AS conversion_rate
FROM regions r
JOIN customers c ON r.RegionName = c.Region
JOIN optins o ON c.CustomerID = o.CustomerID
GROUP BY r.RegionName
ORDER BY conversion_rate DESC;
```
### Business Problem 9
Analyze how business revenues have changed over months.

### Business Impact:
This analysis enables businesses to track financial growth trends and assess the impact of seasonal campaigns or promotions. 
It supports data-driven decision-making for revenue optimization strategies.

```sql
SELECT YEAR(p.PaymentDate) AS payment_year, MONTH(p.PaymentDate) AS payment_month, 
       SUM(p.Amount) AS monthly_revenue
FROM payments p
GROUP BY YEAR(p.PaymentDate), MONTH(p.PaymentDate)
ORDER BY payment_year, payment_month;
```
### Business Problem 10
Calculate the retention rate (percentage of confirmed opt-ins) for each region based on total customers in the region.

### Business Impact:
Measuring retention rates helps businesses evaluate the effectiveness of their regional campaigns and engagement strategies. 
It provides actionable insights for improving customer loyalty and reducing churn.

```sql
SELECT r.RegionName, 
       COUNT(o.CustomerID) AS total_confirmed_optins,
       COUNT(c.CustomerID) AS total_customers,
       (COUNT(o.CustomerID) * 100.0 / COUNT(c.CustomerID)) AS retention_rate
FROM Regions r
JOIN Customers c ON r.RegionName = c.Region
LEFT JOIN OptIns o ON c.CustomerID = o.CustomerID AND o.OptInStatus = 'Confirmed'
GROUP BY r.RegionName;
```
### Techniques Used

- **SQL Aggregation Functions** : Utilized `SUM()`, `COUNT()`, and `AVG()` to summarize data effectively.
- **Joins** : Combined data from multiple tables using `JOIN` operations to create comprehensive reports.
- **Window Functions** : Used `RANK()`, `DENSE_RANK()`, and `ROW_NUMBER()`for advanced analysis without collapsing the result set.
- **Filtering and Grouping** : Employed `WHERE`, `GROUP BY`, and `HAVING` clauses to refine data analysis.
- **Date Functions** : Applied `YEAR()` and `MONTH()` to analyze trends over time.
- **CTE** : Simplified complex queries by breaking them into manageable parts using `WITH`.

## Project Overview:
This project focuses on analyzing data from a **WhatsApp Business API** platform Called **Popplereach Technologies** to provide actionable insights for customer engagement,
operational efficiency, and revenue optimization. The dataset simulates key entities like customers, messages, agents, regions, conversations, and payments,
representing real-world interactions between businesses and customers.

### Challenge Addressed:
The challenge addressed by this project was to derive actionable business insights using SQL queries to analyze customer interactions, payments, conversation data, and template usage. This was done to enhance operational efficiency, improve decision-making, and prioritize business actions such as identifying high-value customers, tracking the effectiveness of communication templates, and understanding regional performance. By utilizing SQL techniques such as aggregation, joins, window functions, and subqueries, the project aimed to provide data-driven solutions for business growth and optimization.

### Objectives:

**Customer Insights:** Identify behavior and preferences, such as opt-ins and message interaction trends.

**Operational Efficiency:** Evaluate agent performance and conversation quality for optimization.

**Revenue Tracking:** Analyze revenue streams generated from paid conversations and identify top contributors.

**Campaign Optimization:** Track the effectiveness of templates and regions to optimize communication strategies.

**Regional Trends:** Understand customer retention and engagement patterns across different regions.

### Key Analytical Goals:

**Customer Analysis:** Determine which customers have opted in but not interacted, enabling targeted outreach.

**Agent Performance:** Assess agents based on average conversation quality, helping in resource allocation and training.

**Revenue Trends:** Evaluate business revenue patterns monthly and identify top-paying customers for strategic engagement.

**Campaign Insights:** Understand which templates are most used and regions with high confirmed opt-ins to refine future campaigns.

**Retention Analysis:** Calculate retention rates for each region to measure effectiveness in retaining customers.

## Disclaimer:
This project is entirely created by me during my tenure at **Popplereach Technologies.** The data used in this project is fictional and has been generated for analytical and educational purposes only.
It does not reflect any real-world business data or transactions.
Any resemblance to actual events or entities is purely coincidental. This work is a representation of the type of analysis and solutions developed while working at **Popplereach Technologies** and is not available elsewhere.














